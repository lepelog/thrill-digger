(this["webpackJsonpthrill-digger-react"]=this["webpackJsonpthrill-digger-react"]||[]).push([[0],{1:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return C}));var n,r=i(3),o=i(4),s=i(7),a=i(6),c=i(2),l=i.n(c),u=i(9),d=i.n(u),b=(i(29),i.p+"static/media/Unspecified.87384eb5.webp"),p=i.p+"static/media/GreenRupee.e3b197ea.webp",h=i.p+"static/media/BlueRupee.d3692eb5.webp",f=i.p+"static/media/RedRupee.9cccfd9f.webp",g=i.p+"static/media/SilverRupee.26703e7c.webp",v=i.p+"static/media/GoldRupee.05b47142.webp",j=i.p+"static/media/Rupoor.2126f62f.webp",m=i.p+"static/media/Bomb.a989e581.webp",O=i(0);!function(e){e[e.Unspecified=0]="Unspecified",e[e.GreenRupee=1]="GreenRupee",e[e.BlueRupee=2]="BlueRupee",e[e.RedRupee=3]="RedRupee",e[e.SilverRupee=4]="SilverRupee",e[e.GoldRupee=5]="GoldRupee",e[e.Rupoor=6]="Rupoor",e[e.Bomb=7]="Bomb"}(n||(n={}));var y=[n.Unspecified,n.GreenRupee,n.BlueRupee,n.RedRupee,n.SilverRupee,n.GoldRupee,n.Rupoor,n.Bomb],R="#53fc05",k="#349b04",x=d()([R,k]),S=d()(["#fcf80c","#a30800"]),C=function(e){Object(s.a)(i,e);var t=Object(a.a)(i);function i(e){var n;return Object(r.a)(this,i),(n=t.call(this,e)).contentImages=void 0,n.contentImages=[b,p,h,f,g,v,j,m],n}return Object(o.a)(i,[{key:"onSelectChange",value:function(e){this.props.selectionChangedCallback(this.props.index,e)}},{key:"getBgColor",value:function(e,t,i){if(!isFinite(t))return"unset";if(0===t)return 0===i?R:k;return e<4?x(e/4):S(t)}},{key:"render",value:function(){var e=this,t=this.props,i=t.probabilities,r=t.selectedState,o=t.ranking,s=i[n.Bomb],a=i[n.Rupoor],c=r===n.Unspecified?this.getBgColor(o,s,a):"unset";return Object(O.jsxs)("div",{className:"grid-field",style:{backgroundColor:c},children:[Object(O.jsxs)("div",{children:["bomb probability: ",(100*s).toFixed(2),"%"]}),Object(O.jsxs)("div",{children:["rupoor probability: ",(100*a).toFixed(2),"%"]}),Object(O.jsx)("div",{children:y.map((function(t,o){return 0==i[o]?null:Object(O.jsx)("img",{className:(o===r?"content-image-highlighted ":"")+"content-image",src:e.contentImages[o],alt:(s=t,n[s]),onClick:e.onSelectChange.bind(e,o),width:20},o);var s}))})]})}}]),i}(l.a.Component)},12:function(e,t,i){"use strict";(function(e){var n=i(13),r=i(3),o=i(4),s=i(5),a=i(7),c=i(6),l=i(2),u=i.n(l),d=(i(22),i(1)),b=i(0),p=function(t){Object(a.a)(u,t);var l=Object(c.a)(u);function u(e){var t;return Object(r.a)(this,u),(t=l.call(this,e)).state={nativeModule:null,currentMessage:"waiting to initialize...",solver:null,cellStates:[{probabilities:new Array(8).fill(0),selectedType:d.b.Unspecified,ranking:100}],boardHeight:0,boardWidth:0,possibleLoops:[],matchingSeedCount:-1},t.selectedChanged=t.selectedChanged.bind(Object(s.a)(t)),t}return Object(o.a)(u,[{key:"componentDidMount",value:function(){var t=this;i.e(3).then(i.bind(null,32)).then((function(i){t.setState({nativeModule:i,currentMessage:"computing values...",solver:i.create_solver()}),e((function(){var e;console.log("setting state"),null===(e=t.state.solver)||void 0===e||e.cache_boards();var i=t.state.solver.get_height(),n=t.state.solver.get_width(),r=Array(i*n).fill(0).map((function(){return{probabilities:new Array(8).fill(0),selectedType:d.b.Unspecified,ranking:100}}));t.setState({currentMessage:"done!",boardWidth:n,boardHeight:i,cellStates:r}),t.updateBoardAndRecalculateProbs(r)}))}))}},{key:"componentWillUnmount",value:function(){var e;null===(e=this.state.solver)||void 0===e||e.free()}},{key:"getSolverOrError",value:function(){if(null===this.state.solver)throw Error("solver is null!");return this.state.solver}},{key:"selectedChanged",value:function(e,t){var i=this.state.cellStates;i[e].selectedType==t&&(t=d.b.Unspecified),i[e].selectedType=t,this.getSolverOrError().set_hole(e,t),this.updateBoardAndRecalculateProbs(i)}},{key:"updateBoardAndRecalculateProbs",value:function(e){var t=this.getSolverOrError();t.calculate_probabilities_with_pregenerated(),e.forEach((function(e,i){e.probabilities.forEach((function(n,r){e.probabilities[r]=t.get_a_probability(i,r)}))}));var i=e.filter((function(e){return e.selectedType===d.b.Unspecified})).map((function(e,t){return[t,e]}));i.sort((function(e,t){return e[1].probabilities[d.b.Bomb]-t[1].probabilities[d.b.Bomb]||e[1].probabilities[d.b.Rupoor]-t[1].probabilities[d.b.Rupoor]})),i.forEach((function(e,t){var i=Object(n.a)(e,2);i[0];return i[1].ranking=t})),e.forEach((function(e){e.selectedType!==d.b.Unspecified&&(e.ranking=100)})),this.setState({cellStates:e,matchingSeedCount:t.get_possible_rng_values_count(),possibleLoops:this.getPossibleLoopArray(t)})}},{key:"getPossibleLoopArray",value:function(e){var t=new Uint8Array(9);e.get_possible_loops(t);var i=[];return t.forEach((function(e,t){i.push(1===e)})),i}},{key:"resetPossibleLoopArray",value:function(){this.getSolverOrError().reset_possible_loops(),this.updateBoardAndRecalculateProbs(this.state.cellStates)}},{key:"setPossibleLoop",value:function(e,t){this.getSolverOrError().set_possible_loop(e,t),this.updateBoardAndRecalculateProbs(this.state.cellStates)}},{key:"resetBoard",value:function(){for(var e,t,i=(null===(e=this.state.solver)||void 0===e?void 0:e.get_height())||0,n=(null===(t=this.state.solver)||void 0===t?void 0:t.get_width())||0,r=Array(i*n).fill(0).map((function(){return{probabilities:new Array(8).fill(0),selectedType:d.b.Unspecified,ranking:100}})),o=this.getSolverOrError(),s=0;s<i*n;s++)o.set_hole(s,d.b.Unspecified);this.updateBoardAndRecalculateProbs(r)}},{key:"render",value:function(){var e=this,t=this.state,i=t.boardHeight,n=t.boardWidth,r=t.cellStates,o=t.currentMessage,s=t.matchingSeedCount,a=t.possibleLoops;return Object(b.jsxs)("div",{className:"App",children:[Object(b.jsx)("h1",{children:"Thrill Digger Expert solver"}),Object(b.jsx)("div",{children:o}),Object(b.jsxs)("div",{children:["matching seeds: ",s]}),Object(b.jsxs)("div",{children:["Possible Loops: ",a.map((function(t,i){return Object(b.jsxs)("span",{children:[Object(b.jsx)("input",{type:"checkbox",checked:t,onChange:function(t){return e.setPossibleLoop(i,t.target.checked)}}),i]})}))]}),Object(b.jsx)("div",{children:Object(b.jsx)("button",{onClick:this.resetPossibleLoopArray.bind(this),children:"Reset Loops"})}),Object(b.jsx)("table",{children:Object(b.jsx)("tbody",{children:Array(i).fill(0).map((function(t,i){return Object(b.jsx)("tr",{children:Array(n).fill(0).map((function(t,o){var s=i*n+o,a=r[s];return Object(b.jsx)("td",{children:Object(b.jsx)(d.a,{probabilities:a.probabilities,selectedState:a.selectedType,index:s,selectionChangedCallback:e.selectedChanged,ranking:a.ranking},s)})}))})}))})}),Object(b.jsx)("button",{onClick:this.resetBoard.bind(this),children:"Reset"}),Object(b.jsxs)("div",{children:["Source code: ",Object(b.jsx)("a",{href:"https://github.com/lepelog/thrill-digger",children:"GitHub"})]})]})}}]),u}(u.a.Component);t.a=function(){return Object(b.jsx)(p,{})}}).call(this,i(19).setImmediate)},18:function(e,t,i){},22:function(e,t,i){},29:function(e,t,i){},31:function(e,t,i){"use strict";i.r(t);var n=i(2),r=i.n(n),o=i(11),s=i.n(o),a=(i(18),i(12)),c=function(e){e&&e instanceof Function&&i.e(4).then(i.bind(null,36)).then((function(t){var i=t.getCLS,n=t.getFID,r=t.getFCP,o=t.getLCP,s=t.getTTFB;i(e),n(e),r(e),o(e),s(e)}))},l=i(0);s.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(a.a,{})}),document.getElementById("root")),c()}},[[31,1,2]]]);
//# sourceMappingURL=main.6d5645bc.chunk.js.map